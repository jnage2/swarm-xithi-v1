
# Reflexion 

# VM:
# 3 Master (RAM 4GB, CPU 2, HDD 30GB, NetInt 3)
# 4 Worker (RAM 16GB, CPU 2, HDD 30GB, HDD_CEPH _GB, NetInt 3)

# NET:
# 1 - DMZ       - 10.255.1.1/24 - (Permet l'accès aux services herberger)
# 2 - SWARM     - 10.20.20.1/24 - (Permet la communication entre les noeuds swarm)
# 3 - GLSTR     - 10.30.30.1/24 - (Permet la communication entre les noeuds gluster)
# 4 - MNGT      - 10.12.0.254/24  

# Plage IP des Manager : de 11 à 18 (7 Managers Max pour un cluster)
# Plage IP des Worker  : de 21 à 31 (Pas de limite de Workers)

[swarm:children]  # Groupe parent pour managers et workers
managers
workers

[managers] # SWARM (MAX 7)
arf-swarm-m-750-01 ansible_host=10.12.0.61 ansible_host_swarm=10.20.20.11 ansible_host_glstr=10.30.30.11 ansible_host_dmz=10.255.1.11 
arf-swarm-m-750-02 ansible_host=10.12.0.62 ansible_host_swarm=10.20.20.12 ansible_host_glstr=10.30.30.12 ansible_host_dmz=10.255.1.12
arf-swarm-m-750-03 ansible_host=10.12.0.63 ansible_host_swarm=10.20.20.13 ansible_host_glstr=10.30.30.13 ansible_host_dmz=10.255.1.13

[workers] # SWARM
arf-swarm-w-750-01 ansible_host=10.12.0.71 ansible_host_swarm=10.20.20.21 ansible_host_glstr=10.30.30.21 ansible_host_dmz=10.255.1.21
arf-swarm-w-750-02 ansible_host=10.12.0.72 ansible_host_swarm=10.20.20.22 ansible_host_glstr=10.30.30.22 ansible_host_dmz=10.255.1.22 
arf-swarm-w-750-03 ansible_host=10.12.0.73 ansible_host_swarm=10.20.20.23 ansible_host_glstr=10.30.30.23 ansible_host_dmz=10.255.1.23
arf-swarm-w-750-04 ansible_host=10.12.0.74 ansible_host_swarm=10.20.20.24 ansible_host_glstr=10.30.30.24 ansible_host_dmz=10.255.1.24

[gluster_peers] # GLUSTERFS
arf-glstr-750-01 ansible_host=10.12.0.91 ansible_host_glstr=10.30.30.41 
arf-glstr-750-02 ansible_host=10.12.0.92 ansible_host_glstr=10.30.30.42 
arf-glstr-750-03 ansible_host=10.12.0.93 ansible_host_glstr=10.30.30.43 

[swarm:vars]  # Variables pour l'ensemble des managers et workers
interfaces_dmz=ens160
interfaces_swarm=ens192
interfaces_glusterfs=ens224
interfaces_mngt=ens256
path_config_netplan=/etc/netplan/01-custom-network.yaml 

[gluster_peers:vars]  # Variables spécifiques aux peers GlusterFS
interfaces_glusterfs=ens160
interfaces_mngt=ens192
path_config_netplan=/etc/netplan/50-cloud-init.yaml



[all:vars]
#current_ceph_fsid="YOUR-CEPH-FSID"
ansible_user=adminm3arf
ansible_interpreter=/usr/local/lib/python3.11.2
ansible_python_interpreter=/usr/bin/python3

network_swarm=10.20.20.0
network_ceph=10.30.30.0
default_gateway=10.255.1.254
dns_nameservers=10.255.1.254







### OUT ###

ceph_dashboard_password=#########
osd_device=/dev/sdb
ceph_secret=#########=AQDRpa5mGsM4LxAAiWgF1+XcV1fZMy3gnABw==
current_ceph_fsid==#########1c32c96e-38f4-41c2-86f2-fef246af2b

swarm_endpoint=localswarm3

custom_icon_path="=#########_TEMP/logo_xithi.png"

portainer_image=portainer/portainer-ce
portainer_port=9000
portainer_volume=/mnt/cephfs/portainer
portainer_endpoint_name=swarm-cluster
portainer_url=http://{{ ansible_host }}:9000
portainer_username=admin
portainer_password=##############

gitlab_image=gitlab/gitlab-ce:latest
gitlab_external_url="http://{{ ansible_host }}"
gitlab_http_port=8929
gitlab_https_port=8930
gitlab_ssh_port=2224
gitlab_path_volume=/mnt/cephfs/gitlab/

gitlab_data_dir=gitlab-data
gitlab_logs_dir=gitlab-logs
gitlab_config_dir=gitlab-config


; [monitors:children] # CEPH Monitors
; workers

; [ods:children] # CEPH OSDs
; workers

; [clients:children] # CEPH Clients
; workers

#[all:vars]
#ansible_host_swarm="{{ ansible_host | regex_replace('10\\.255\\.1\\.', '10.20.20.') }}"
#ansible_host_glstr="{{ ansible_host | regex_replace('10\\.255\\.1\\.', '10.30.30.') }}"